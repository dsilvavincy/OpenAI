# Copilot Instructions for AI-Driven T12 Data Question Generator

## Project Overview
This is an AI-driven T12 property financial data analysis tool that generates strategic questions and insights for real estate investment decisions. The final deliverable is a desktop application with a professional UI.

## Critical Workflow Rule: CHECKLIST-DRIVEN DEVELOPMENT
**üö® MANDATORY: All development MUST follow the Implementation Checklist in strict sequential order.**

### Checklist Enforcement Rules:
1. **Before any code changes**: Check current status in `IMPLEMENTATION_CHECKLIST.md`
2. **Only work on current uncompleted stage**: Do not skip ahead or work on future stages
3. **After completing any task**: Update the checklist by marking the completed item with [x]
4. **Stage validation required**: Each stage must be fully completed and tested before moving to next
5. **No parallel development**: Complete each checklist item sequentially

### Current Project Structure:
```
/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # Main CLI entry point (legacy)
‚îÇ   ‚îú‚îÄ‚îÄ preprocess.py        # Robust T12 Excel data processing
‚îÇ   ‚îú‚îÄ‚îÄ kpi_summary.py       # KPI extraction and summary generation
‚îÇ   ‚îî‚îÄ‚îÄ prompt.py            # Standardized AI prompts and OpenAI integration
‚îú‚îÄ‚îÄ app.py                   # Streamlit UI application
‚îú‚îÄ‚îÄ requirements.txt         # Dependencies
‚îî‚îÄ‚îÄ IMPLEMENTATION_CHECKLIST.md  # **THE MASTER CHECKLIST - ALWAYS FOLLOW**
```

## Technical Context

### Data Format:
- T12 Excel files with metrics in rows and months in columns
- Format: `Metrics | Jul 2024 | Aug 2024 | Sep 2024 | YTD`
- Monetary values: `$271.16`, `($52.71)` (parentheses = negative)
- Expected metrics: Property Asking Rent, Effective Rental Income, Vacancy, etc.

### Technology Stack:
- **Backend**: Python with pandas, openpyxl for Excel processing
- **AI**: OpenAI GPT-4-turbo for analysis
- **Frontend**: Streamlit for web UI
- **Packaging**: PyInstaller for desktop executable
- **Data Processing**: Robust regex-based Excel parsing with money formatting

### Key Components:
1. **Preprocessing**: Uses regex pattern matching to find headers, handles Excel variations
2. **KPI Summary**: Generates standardized bullet-point summaries for AI consumption
3. **AI Prompts**: Structured prompts for consistent real estate analysis
4. **UI**: Professional Streamlit interface with file upload and report export

## Development Guidelines

### 1. Checklist Compliance (MANDATORY)
```markdown
BEFORE any work:
- [ ] Read current checklist status
- [ ] Identify next incomplete item
- [ ] Work ONLY on that item

AFTER completing work:
- [ ] Test the implementation
- [ ] Update checklist with [x]
- [ ] Verify stage completion before moving forward
```

### 2. Code Quality Standards
- **Error Handling**: Every function must have try/catch with meaningful error messages
- **Data Validation**: Validate all inputs, especially Excel file formats
- **Type Hints**: Use type hints for all function parameters and returns
- **Documentation**: Clear docstrings for all functions
- **Testing**: Test with real T12 data before marking checklist items complete

### 3. UI Requirements (Critical)
- **No Console Interaction**: Everything must work through Streamlit UI
- **Professional Appearance**: Clean, business-appropriate interface
- **Progress Indicators**: Show loading states for long operations
- **Error Display**: User-friendly error messages in UI
- **Export Functionality**: Professional PDF/Word report generation

### 4. Standardization Requirements
- **Consistent AI Prompts**: Use standardized templates for reliable outputs
- **Reproducible Results**: Same input should produce similar analysis
- **Weekly Workflow**: Design for repeated weekly use with minimal user intervention
- **Quality Control**: Validate AI outputs for relevance and completeness

## Prohibited Actions
‚ùå **DO NOT:**
- Skip checklist items or work ahead of current stage
- Modify core preprocessing logic without updating checklist
- Create console-only features (must be UI-accessible)
- Make changes without testing with actual T12 data
- Mark checklist items complete without proper validation

## Weekly Workflow Target
The final application should enable this workflow:
1. User uploads T12 Excel file via UI
2. System validates and processes data automatically
3. Generate standardized KPI summary
4. AI analyzes data with consistent prompts
5. Professional report generated with insights and recommendations
6. Export to PDF/Word with timestamp and property details

## Integration Points
- **OpenAI API**: Requires user's API key input in UI
- **Excel Processing**: Must handle various T12 formats robustly
- **Report Generation**: Professional formatting for business use
- **Desktop Packaging**: Final executable for Windows distribution

## Success Metrics
- [ ] All checklist items completed sequentially
- [ ] UI handles complete workflow without console interaction
- [ ] Consistent AI analysis quality across different T12 files
- [ ] Professional report output suitable for business decisions
- [ ] Desktop application runs independently

Remember: **The checklist is the law. Follow it religiously for project success.**
